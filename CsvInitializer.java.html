<html>
<head>
<title>CsvInitializer.java</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #7a7e85;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
CsvInitializer.java</font>
</center></td></tr></table>
<pre><span class="s0">package </span><span class="s1">com</span><span class="s2">.</span><span class="s1">example</span><span class="s2">.</span><span class="s1">utils</span><span class="s2">;</span>

<span class="s0">import </span><span class="s1">com</span><span class="s2">.</span><span class="s1">opencsv</span><span class="s2">.</span><span class="s1">CSVWriter</span><span class="s2">;</span>

<span class="s0">import </span><span class="s1">java</span><span class="s2">.</span><span class="s1">io</span><span class="s2">.</span><span class="s1">FileWriter</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">java</span><span class="s2">.</span><span class="s1">io</span><span class="s2">.</span><span class="s1">IOException</span><span class="s2">;</span>
<span class="s0">import </span><span class="s1">java</span><span class="s2">.</span><span class="s1">nio</span><span class="s2">.</span><span class="s1">charset</span><span class="s2">.</span><span class="s1">StandardCharsets</span><span class="s2">;</span>

<span class="s0">public class </span><span class="s1">CsvInitializer </span><span class="s2">{</span>

    <span class="s0">private static final </span><span class="s1">String BASE_PATH </span><span class="s2">= </span><span class="s3">&quot;demo/src/main/resources/&quot;</span><span class="s2">;</span>

    <span class="s0">public static void </span><span class="s1">main</span><span class="s2">(</span><span class="s1">String</span><span class="s2">[] </span><span class="s1">args</span><span class="s2">) {</span>
        <span class="s4">// 创建标准的 CSV 文件</span>
        <span class="s1">createCsvFile</span><span class="s2">(</span><span class="s3">&quot;record.csv&quot;</span><span class="s2">, </span><span class="s0">new </span><span class="s1">String</span><span class="s2">[][]{</span>
                <span class="s2">{</span><span class="s3">&quot;Payment ID&quot;</span><span class="s2">, </span><span class="s3">&quot;Payment Date&quot;</span><span class="s2">, </span><span class="s3">&quot;Amount&quot;</span><span class="s2">, </span><span class="s3">&quot;Category&quot;</span><span class="s2">, </span><span class="s3">&quot;Payee&quot;</span><span class="s2">},</span>
                <span class="s2">{</span><span class="s3">&quot;1&quot;</span><span class="s2">, </span><span class="s3">&quot;2025-04-10 12:00&quot;</span><span class="s2">, </span><span class="s3">&quot;58.5&quot;</span><span class="s2">, </span><span class="s3">&quot;food&quot;</span><span class="s2">, </span><span class="s3">&quot;alice&quot;</span><span class="s2">},</span>
                <span class="s2">{</span><span class="s3">&quot;2&quot;</span><span class="s2">, </span><span class="s3">&quot;2025-04-11 09:30&quot;</span><span class="s2">, </span><span class="s3">&quot;120.0&quot;</span><span class="s2">, </span><span class="s3">&quot;transportation&quot;</span><span class="s2">, </span><span class="s3">&quot;bob&quot;</span><span class="s2">},</span>
                <span class="s2">{</span><span class="s3">&quot;3&quot;</span><span class="s2">, </span><span class="s3">&quot;2025-04-12 20:15&quot;</span><span class="s2">, </span><span class="s3">&quot;75.0&quot;</span><span class="s2">, </span><span class="s3">&quot;entertainment&quot;</span><span class="s2">, </span><span class="s3">&quot;charlie&quot;</span><span class="s2">},</span>
        <span class="s2">});</span>

        <span class="s4">// 序号列错乱的 CSV 文件</span>
        <span class="s1">createCsvFile</span><span class="s2">(</span><span class="s3">&quot;record_food.csv&quot;</span><span class="s2">, </span><span class="s0">new </span><span class="s1">String</span><span class="s2">[][]{</span>
                <span class="s2">{</span><span class="s3">&quot;Payment ID&quot;</span><span class="s2">, </span><span class="s3">&quot;Payment Date&quot;</span><span class="s2">, </span><span class="s3">&quot;Amount&quot;</span><span class="s2">, </span><span class="s3">&quot;Category&quot;</span><span class="s2">, </span><span class="s3">&quot;Payee&quot;</span><span class="s2">},</span>
                <span class="s2">{</span><span class="s3">&quot;1&quot;</span><span class="s2">, </span><span class="s3">&quot;2025-04-01 08:15&quot;</span><span class="s2">, </span><span class="s3">&quot;32.0&quot;</span><span class="s2">, </span><span class="s3">&quot;food&quot;</span><span class="s2">, </span><span class="s3">&quot;david&quot;</span><span class="s2">},</span>
                <span class="s2">{</span><span class="s3">&quot;3&quot;</span><span class="s2">, </span><span class="s3">&quot;2025-04-06 18:30&quot;</span><span class="s2">, </span><span class="s3">&quot;27.3&quot;</span><span class="s2">, </span><span class="s3">&quot;food&quot;</span><span class="s2">, </span><span class="s3">&quot;frank&quot;</span><span class="s2">},</span>
                <span class="s2">{</span><span class="s3">&quot;2&quot;</span><span class="s2">, </span><span class="s3">&quot;2025-04-03 13:45&quot;</span><span class="s2">, </span><span class="s3">&quot;45.5&quot;</span><span class="s2">, </span><span class="s3">&quot;food&quot;</span><span class="s2">, </span><span class="s3">&quot;emma&quot;</span><span class="s2">},</span>
        <span class="s2">});</span>

        <span class="s4">// 创建错误的 CSV 文件：类别错误</span>
        <span class="s1">createCsvFile</span><span class="s2">(</span><span class="s3">&quot;record_education.csv&quot;</span><span class="s2">, </span><span class="s0">new </span><span class="s1">String</span><span class="s2">[][]{</span>
                <span class="s2">{</span><span class="s3">&quot;Payment ID&quot;</span><span class="s2">, </span><span class="s3">&quot;Payment Date&quot;</span><span class="s2">, </span><span class="s3">&quot;Amount&quot;</span><span class="s2">, </span><span class="s3">&quot;Category&quot;</span><span class="s2">, </span><span class="s3">&quot;Payee&quot;</span><span class="s2">},</span>
                <span class="s2">{</span><span class="s3">&quot;1&quot;</span><span class="s2">, </span><span class="s3">&quot;2025-03-20 10:00&quot;</span><span class="s2">, </span><span class="s3">&quot;300.0&quot;</span><span class="s2">, </span><span class="s3">&quot;education&quot;</span><span class="s2">, </span><span class="s3">&quot;george&quot;</span><span class="s2">},</span>
                <span class="s2">{</span><span class="s3">&quot;2&quot;</span><span class="s2">, </span><span class="s3">&quot;2025-03-25 16:30&quot;</span><span class="s2">, </span><span class="s3">&quot;150.0&quot;</span><span class="s2">, </span><span class="s3">&quot;education&quot;</span><span class="s2">, </span><span class="s3">&quot;hannah&quot;</span><span class="s2">},</span>
                <span class="s2">{</span><span class="s3">&quot;3&quot;</span><span class="s2">, </span><span class="s3">&quot;2025-03-26 16:45&quot;</span><span class="s2">, </span><span class="s3">&quot;200.0&quot;</span><span class="s2">, </span><span class="s3">&quot;eating&quot;</span><span class="s2">, </span><span class="s3">&quot;sen&quot;</span><span class="s2">},</span>
        <span class="s2">});</span>

        <span class="s4">// 创建错误的 CSV 文件：缺少日期列</span>
        <span class="s1">createCsvFile</span><span class="s2">(</span><span class="s3">&quot;record_missing_date.csv&quot;</span><span class="s2">, </span><span class="s0">new </span><span class="s1">String</span><span class="s2">[][]{</span>
                <span class="s2">{</span><span class="s3">&quot;Payment ID&quot;</span><span class="s2">, </span><span class="s3">&quot;Payment Date&quot;</span><span class="s2">, </span><span class="s3">&quot;Amount&quot;</span><span class="s2">, </span><span class="s3">&quot;Category&quot;</span><span class="s2">, </span><span class="s3">&quot;Payee&quot;</span><span class="s2">},</span>
                <span class="s2">{</span><span class="s3">&quot;1&quot;</span><span class="s2">, </span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s3">&quot;100.0&quot;</span><span class="s2">, </span><span class="s3">&quot;food&quot;</span><span class="s2">, </span><span class="s3">&quot;John&quot;</span><span class="s2">},</span>
                <span class="s2">{</span><span class="s3">&quot;2&quot;</span><span class="s2">, </span><span class="s3">&quot;200.0&quot;</span><span class="s2">, </span><span class="s3">&quot;transportation&quot;</span><span class="s2">, </span><span class="s3">&quot;Mary&quot;</span><span class="s2">},</span>
        <span class="s2">});</span>

        <span class="s4">// 创建错误的 CSV 文件：金额列非数字</span>
        <span class="s1">createCsvFile</span><span class="s2">(</span><span class="s3">&quot;record_invalid_amount.csv&quot;</span><span class="s2">, </span><span class="s0">new </span><span class="s1">String</span><span class="s2">[][]{</span>
                <span class="s2">{</span><span class="s3">&quot;Payment ID&quot;</span><span class="s2">, </span><span class="s3">&quot;Payment Date&quot;</span><span class="s2">, </span><span class="s3">&quot;Amount&quot;</span><span class="s2">, </span><span class="s3">&quot;Category&quot;</span><span class="s2">, </span><span class="s3">&quot;Payee&quot;</span><span class="s2">},</span>
                <span class="s2">{</span><span class="s3">&quot;1&quot;</span><span class="s2">, </span><span class="s3">&quot;2025-04-01 10:00&quot;</span><span class="s2">, </span><span class="s3">&quot;abc&quot;</span><span class="s2">, </span><span class="s3">&quot;food&quot;</span><span class="s2">, </span><span class="s3">&quot;John&quot;</span><span class="s2">},</span>
                <span class="s2">{</span><span class="s3">&quot;2&quot;</span><span class="s2">, </span><span class="s3">&quot;2025-04-02 11:00&quot;</span><span class="s2">, </span><span class="s3">&quot;150.75&quot;</span><span class="s2">, </span><span class="s3">&quot;transportation&quot;</span><span class="s2">, </span><span class="s3">&quot;Mary&quot;</span><span class="s2">},</span>
        <span class="s2">});</span>

        <span class="s4">// 创建错误的 CSV 文件：日期格式错误</span>
        <span class="s1">createCsvFile</span><span class="s2">(</span><span class="s3">&quot;record_invalid_date_format.csv&quot;</span><span class="s2">, </span><span class="s0">new </span><span class="s1">String</span><span class="s2">[][]{</span>
                <span class="s2">{</span><span class="s3">&quot;Payment ID&quot;</span><span class="s2">, </span><span class="s3">&quot;Payment Date&quot;</span><span class="s2">, </span><span class="s3">&quot;Amount&quot;</span><span class="s2">, </span><span class="s3">&quot;Category&quot;</span><span class="s2">, </span><span class="s3">&quot;Payee&quot;</span><span class="s2">},</span>
                <span class="s2">{</span><span class="s3">&quot;1&quot;</span><span class="s2">, </span><span class="s3">&quot;2025/04/01&quot;</span><span class="s2">, </span><span class="s3">&quot;100.0&quot;</span><span class="s2">, </span><span class="s3">&quot;food&quot;</span><span class="s2">, </span><span class="s3">&quot;John&quot;</span><span class="s2">},</span>
                <span class="s2">{</span><span class="s3">&quot;2&quot;</span><span class="s2">, </span><span class="s3">&quot;2025-04-02T11:00&quot;</span><span class="s2">, </span><span class="s3">&quot;200.0&quot;</span><span class="s2">, </span><span class="s3">&quot;transportation&quot;</span><span class="s2">, </span><span class="s3">&quot;Mary&quot;</span><span class="s2">},</span>
                <span class="s2">{</span><span class="s3">&quot;3&quot;</span><span class="s2">, </span><span class="s3">&quot;2025-03-25&quot;</span><span class="s2">, </span><span class="s3">&quot;150.0&quot;</span><span class="s2">, </span><span class="s3">&quot;education&quot;</span><span class="s2">, </span><span class="s3">&quot;hannah&quot;</span><span class="s2">}</span>
        <span class="s2">});</span>

        <span class="s4">// 创建错误的 CSV 文件：缺少一列（Payee 列缺失）</span>
        <span class="s1">createCsvFile</span><span class="s2">(</span><span class="s3">&quot;record_missing_column.csv&quot;</span><span class="s2">, </span><span class="s0">new </span><span class="s1">String</span><span class="s2">[][]{</span>
                <span class="s2">{</span><span class="s3">&quot;Payment ID&quot;</span><span class="s2">, </span><span class="s3">&quot;Payment Date&quot;</span><span class="s2">, </span><span class="s3">&quot;Amount&quot;</span><span class="s2">, </span><span class="s3">&quot;Category&quot;</span><span class="s2">},</span>
                <span class="s2">{</span><span class="s3">&quot;1&quot;</span><span class="s2">, </span><span class="s3">&quot;2025-04-03 12:00&quot;</span><span class="s2">, </span><span class="s3">&quot;50.0&quot;</span><span class="s2">, </span><span class="s3">&quot;entertainment&quot;</span><span class="s2">},</span>
                <span class="s2">{</span><span class="s3">&quot;2&quot;</span><span class="s2">, </span><span class="s3">&quot;2025-04-04 14:00&quot;</span><span class="s2">, </span><span class="s3">&quot;75.0&quot;</span><span class="s2">, </span><span class="s3">&quot;education&quot;</span><span class="s2">},</span>
        <span class="s2">});</span>

        <span class="s4">// 创建错误的 CSV 文件：支付金额为 0 或负数</span>
        <span class="s1">createCsvFile</span><span class="s2">(</span><span class="s3">&quot;record_zero_or_negative_amount.csv&quot;</span><span class="s2">, </span><span class="s0">new </span><span class="s1">String</span><span class="s2">[][]{</span>
                <span class="s2">{</span><span class="s3">&quot;Payment ID&quot;</span><span class="s2">, </span><span class="s3">&quot;Payment Date&quot;</span><span class="s2">, </span><span class="s3">&quot;Amount&quot;</span><span class="s2">, </span><span class="s3">&quot;Category&quot;</span><span class="s2">, </span><span class="s3">&quot;Payee&quot;</span><span class="s2">},</span>
                <span class="s2">{</span><span class="s3">&quot;1&quot;</span><span class="s2">, </span><span class="s3">&quot;2025-04-09 10:30&quot;</span><span class="s2">, </span><span class="s3">&quot;0&quot;</span><span class="s2">, </span><span class="s3">&quot;food&quot;</span><span class="s2">, </span><span class="s3">&quot;John&quot;</span><span class="s2">},</span>
                <span class="s2">{</span><span class="s3">&quot;2&quot;</span><span class="s2">, </span><span class="s3">&quot;2025-04-10 11:00&quot;</span><span class="s2">, </span><span class="s3">&quot;-50.0&quot;</span><span class="s2">, </span><span class="s3">&quot;transportation&quot;</span><span class="s2">, </span><span class="s3">&quot;Mary&quot;</span><span class="s2">},</span>
        <span class="s2">});</span>

        <span class="s1">System</span><span class="s2">.</span><span class="s1">out</span><span class="s2">.</span><span class="s1">println</span><span class="s2">(</span><span class="s3">&quot;✅ 所有 CSV 文件已初始化完毕！&quot;</span><span class="s2">);</span>
    <span class="s2">}</span>

    <span class="s0">private static void </span><span class="s1">createCsvFile</span><span class="s2">(</span><span class="s1">String fileName</span><span class="s2">, </span><span class="s1">String</span><span class="s2">[][] </span><span class="s1">data</span><span class="s2">) {</span>
        <span class="s0">try </span><span class="s2">(</span><span class="s1">CSVWriter writer </span><span class="s2">= </span><span class="s0">new </span><span class="s1">CSVWriter</span><span class="s2">(</span><span class="s0">new </span><span class="s1">FileWriter</span><span class="s2">(</span><span class="s1">BASE_PATH </span><span class="s2">+ </span><span class="s1">fileName</span><span class="s2">, </span><span class="s1">StandardCharsets</span><span class="s2">.</span><span class="s1">UTF_8</span><span class="s2">))) {</span>
            <span class="s0">for </span><span class="s2">(</span><span class="s1">String</span><span class="s2">[] </span><span class="s1">row </span><span class="s2">: </span><span class="s1">data</span><span class="s2">) {</span>
                <span class="s1">writer</span><span class="s2">.</span><span class="s1">writeNext</span><span class="s2">(</span><span class="s1">row</span><span class="s2">);</span>
            <span class="s2">}</span>
        <span class="s2">} </span><span class="s0">catch </span><span class="s2">(</span><span class="s1">IOException e</span><span class="s2">) {</span>
            <span class="s1">System</span><span class="s2">.</span><span class="s1">err</span><span class="s2">.</span><span class="s1">println</span><span class="s2">(</span><span class="s3">&quot;❌ 写入 &quot; </span><span class="s2">+ </span><span class="s1">fileName </span><span class="s2">+ </span><span class="s3">&quot; 失败！&quot;</span><span class="s2">);</span>
            <span class="s1">e</span><span class="s2">.</span><span class="s1">printStackTrace</span><span class="s2">();</span>
        <span class="s2">}</span>
    <span class="s2">}</span>
<span class="s2">}</span>
</pre>
</body>
</html>